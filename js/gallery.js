$(function(){$.fn.imagesLoaded=function(k){var g=this.find("img"),e=g.length,j=this,i="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";function h(){k.call(j,g)}function f(){if(--e<=0&&this.src!==i){setTimeout(h);g.off("load error",f)}}if(!e){h()}g.on("load error",f).each(function(){if(this.complete||this.complete===undefined){var l=this.src;this.src=i;this.src=l}});return this};var b=$("#rg-gallery"),d=b.find("div.es-carousel-wrapper"),c=d.find("ul > li"),a=c.length;Gallery=(function(){var i=0,g="carousel",f=false,n=function(){c.add('<img src="images/ajax-loader.gif"/><img src="images/black.png"/>').imagesLoaded(function(){h();k();m(c.eq(i))});if(g==="carousel"){e()}},e=function(){d.show().elastislide({imageW:65,onClick:function(o){if(f){return false}f=true;m(o);i=o.index()}});d.elastislide("setCurrent",i)},h=function(){var o=$('<a href="#" class="rg-view-full"></a>'),p=$('<a href="#" class="rg-view-thumbs rg-view-selected"></a>');b.prepend($('<div class="rg-view"/>').append(o).append(p));o.on("click.rgGallery",function(q){if(g==="carousel"){d.elastislide("destroy")}d.hide();o.addClass("rg-view-selected");p.removeClass("rg-view-selected");g="fullview";return false});p.on("click.rgGallery",function(q){e();p.addClass("rg-view-selected");o.removeClass("rg-view-selected");g="carousel";return false});if(g==="fullview"){o.trigger("click")}},k=function(){$("#img-wrapper-tmpl").tmpl({itemsCount:a}).appendTo(b);if(a>1){var q=b.find("a.rg-image-nav-prev"),o=b.find("a.rg-image-nav-next"),p=b.find("div.rg-image");q.on("click.rgGallery",function(r){j("left");return false});o.on("click.rgGallery",function(r){j("right");return false});p.touchwipe({wipeLeft:function(){j("right")},wipeRight:function(){j("left")},preventDefaultEvents:false});$(document).on("keyup.rgGallery",function(r){if(r.keyCode==39){j("right")}else{if(r.keyCode==37){j("left")}}})}},j=function(o){if(f){return false}f=true;if(o==="right"){if(i+1>=a){i=0}else{++i}}else{if(o==="left"){if(i-1<0){i=a-1}else{--i}}}m(c.eq(i))},m=function(o){var p=b.find("div.rg-loading").show();c.removeClass("selected");o.addClass("selected");var s=o.find("img"),q=s.data("large"),r=s.data("description");$("<img/>").load(function(){b.find("div.rg-image").empty().append('<img src="'+q+'"/>');if(r){b.find("div.rg-caption").show().children("p").empty().text(r)}p.hide();if(g==="carousel"){d.elastislide("reload");d.elastislide("setCurrent",i)}f=false}).attr("src",q)},l=function(o){d.find("ul").append(o);c=c.add($(o));a=c.length;d.elastislide("add",o)};return{init:n,addItems:l}})();Gallery.init()});;